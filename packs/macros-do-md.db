{"_id":"9A6qo693ftPViuSu","name":"Apaga Vela - Ten Candles","type":"script","author":"VCcbc29NfY7OTjeI","img":"icons/sundries/lights/candle-pillar-lit-yellow.webp","scope":"global","command":"const candleOn = 'modules/md-random-stuff/stuff/tencandles/vela-1-acesa_VP8.webm';\nconst candleBlowingOut = 'modules/md-random-stuff/stuff/tencandles/vela-2-apagando_VP8.webm';\nconst candleOff = 'modules/md-random-stuff/stuff/tencandles/vela-3-apagada_VP8.png';\nconst timeToBlowOut = 5000; // 5 secs - animation time - don't mess with it unless you know what you are doing.\nconst probability = game.settings.get(\"md-random-stuff\", \"chancetoblowcandle\");\n\n/*\nicon: icons/sundries/lights/candle-pillar-lit-yellow.webp\n\n//game.Gametime.doEvery({seconds:10}, \"TestMacro\"); // start to run\n//game.Gametime.flushQueue(); // stop to run\n\nconst currentSceneID = game.scenes.current.id;\ndangerZone.triggerZone('Vento', currentSceneID)\n*/\n\n/*\n== Important - Tags\nstatus_a = on\nstatus_b = Blowing Out\nstatus_c = off\n*/\n\nmain();\nconst version = 'v0.4';\n\nasync function main() {  \n  let candles = await Tagger.getByTag('status_a'); // Select all burning candles \n  let selectedCandle = candles[getRandom(0,candles.length-1)];\n  let candles_on = candles.length;\n  \n  if ( (candles.length>0) && shouldTheCandleDie(probability) ) { //avoid error    \n    changeCandleStatusToOff( Tagger.getTags(selectedCandle) ); // turn off the candle\n\n    let message1 = `Haviam dez.`;\n    let message2 = `Agora tem ${candles_on-1}...`;\n    let chatData = {\n      speaker: null,\n      content: `<div style=\"position:relative; background: #ddd9d5;padding: 0.5rem; margin-left:-7px;margin-right:-7px;margin-bottom:-7px;margin-top:-27px\"><label class=\"titulo\" style=\"font-size:35px; color: #b02b2e;\">Velas</label><div style=\"position: absolute;top: 0;right: 0;width: 50px;height:50px;background: linear-gradient(45deg, #00000000 50%, #000000 50%);\"></div><br><label style=\"font-size: 15px\">${message1}</label><div style=\"margin-top:5px ;height: 5px;width: 100%;background: linear-gradient(20deg,  #000000 70%, #ddd9d500 70%);\"></div><p>${message2}</p></div>`};\n    ChatMessage.create(chatData, {});          \n  }\n}\n\n// FUNCTIONS\nasync function changeCandleStatusToOff(candleTag) {\n  let candle = await Tagger.getByTag(candleTag);  \n  \n  await Tagger.removeTags(candle[0], 'status_a');\n  await Tagger.removeTags(candle[0], 'status_c');\n  await Tagger.addTags(candle[0], 'status_c'); \n  \n  new Sequence()\n    .wait(1500)\n    .thenDo(async() => { \n      await candle[0].document.update({img: candleBlowingOut});\n    })\n    .wait(timeToBlowOut)\n    .thenDo(async() => { \n      await candle[0].document.update({img: candleOff});\n    })      \n    .play()  \n}\n\nfunction getRandom(min, max) { // return between min and max\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\nfunction shouldTheCandleDie(probability) {  \n  if ( probability>=Math.random() ) {\n    return true;\n  } else {\n    return false;\n  }\n}","folder":null,"sort":0,"permission":{"default":0,"VCcbc29NfY7OTjeI":3},"flags":{"core":{"sourceId":"Macro.oWgyfTyH3LgIuXPU"}}}
{"_id":"EABQKBcY62LPptdo","name":"Apaga uma Vela - Ten Candles","type":"script","author":"VCcbc29NfY7OTjeI","img":"icons/sundries/lights/candle-unlit-red.webp","scope":"global","command":"const candleOn = 'modules/md-random-stuff/stuff/tencandles/vela-1-acesa_VP8.webm';\nconst candleBlowingOut = 'modules/md-random-stuff/stuff/tencandles/vela-2-apagando_VP8.webm';\nconst candleOff = 'modules/md-random-stuff/stuff/tencandles/vela-3-apagada_VP8.png';\nconst timeToBlowOut = 5000; // 5 secs - animation time - don't mess with it unless you know what you are doing.\n\n/* APAGA UMA VELA\nicon: icons/sundries/lights/candle-pillar-lit-yellow.webp\n\n*/\n\n/*\n== Important - Tags\nstatus_a = on\nstatus_b = Blowing Out\nstatus_c = off\n*/\n\nmain();\nconst version = 'v0.1';\n\nasync function main() {  \n  let candles = await Tagger.getByTag('status_a'); // Select all burning candles \n  let selectedCandle = candles[getRandom(0,candles.length-1)];\n  let candles_on = candles.length;\n  \n  if ( (candles.length>0) ) { //avoid error    \n    changeCandleStatusToOff( Tagger.getTags(selectedCandle) ); // turn off the candle\n\n    let message1 = `Haviam dez.`;\n    let message2 = `Agora tem ${candles_on-1}...`;\n    let chatData = {\n      speaker: null,\n      content: `<div style=\"position:relative; background: #ddd9d5;padding: 0.5rem; margin-left:-7px;margin-right:-7px;margin-bottom:-7px;margin-top:-27px\"><label class=\"titulo\" style=\"font-size:35px; color: #b02b2e;\">Velas</label><div style=\"position: absolute;top: 0;right: 0;width: 50px;height:50px;background: linear-gradient(45deg, #00000000 50%, #000000 50%);\"></div><br><label style=\"font-size: 15px\">${message1}</label><div style=\"margin-top:5px ;height: 5px;width: 100%;background: linear-gradient(20deg,  #000000 70%, #ddd9d500 70%);\"></div><p>${message2}</p></div>`};\n    ChatMessage.create(chatData, {});          \n  }\n}\n\n// FUNCTIONS\nasync function changeCandleStatusToOff(candleTag) {\n  let candle = await Tagger.getByTag(candleTag);  \n  \n  await Tagger.removeTags(candle[0], 'status_a');\n  await Tagger.removeTags(candle[0], 'status_c');\n  await Tagger.addTags(candle[0], 'status_c'); \n  \n  new Sequence()\n    .wait(1500)\n    .thenDo(async() => { \n      await candle[0].document.update({img: candleBlowingOut});\n    })\n    .wait(timeToBlowOut)\n    .thenDo(async() => { \n      await candle[0].document.update({img: candleOff});\n    })      \n    .play()  \n}\n\nfunction getRandom(min, max) { // return between min and max\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}","folder":null,"sort":0,"permission":{"default":0,"VCcbc29NfY7OTjeI":3},"flags":{"core":{"sourceId":"Macro.2fjSoTvhjSQOZ2GW"}}}
{"name":"Auto Danger - Ten Candles","type":"script","author":"VCcbc29NfY7OTjeI","img":"icons/weapons/thrown/bomb-fuse-red-black.webp","scope":"global","command":"const dangerZoneName = 'Vento'; // dangerzone danger\n\n/*\nicon: icons/weapons/thrown/bomb-fuse-red-black.webp\n*/\n\nconst currentSceneID = game.scenes.current.id;\ndangerZone.triggerZone(dangerZoneName, currentSceneID);","folder":null,"sort":0,"permission":{"default":0,"VCcbc29NfY7OTjeI":3},"flags":{"core":{"sourceId":"Macro.oddZGEi8Nr7cTmwD"}},"_id":"XZ0WQKjf5vOi67Zg"}
{"_id":"pPu1N1Eawij6hORo","name":"Acende uma Vela - Ten Candles","type":"script","author":"VCcbc29NfY7OTjeI","img":"icons/sundries/lights/candle-lit-yellow.webp","scope":"global","command":"const candleOn = 'modules/md-random-stuff/stuff/tencandles/vela-1-acesa_VP8.webm';\nconst candleBlowingOut = 'modules/md-random-stuff/stuff/tencandles/vela-2-apagando_VP8.webm';\nconst candleOff = 'modules/md-random-stuff/stuff/tencandles/vela-3-apagada_VP8.png';\n\n/* ACENDE UMA VELA\nicon: icons/sundries/lights/candle-lit-yellow.webp\n\n*/\n\n/*\n== Important - Tags\nstatus_a = on\nstatus_b = Blowing Out\nstatus_c = off\n*/\n\nmain();\nconst version = 'v0.1';\n\nasync function main() {  \n  let candles = await Tagger.getByTag('status_c'); // Select all burning candles \n  let candlesLength = candles.length;\n  let selectedCandle;\n  \n  if ( candlesLength>0 && candlesLength<=10 ) { //avoid error    \n    selectedCandle = candles[getRandom(0,candles.length-1)];\n    changeCandleStatusToOn( Tagger.getTags(selectedCandle) ); // turn on the candle\n\n    let message1 = `Haviam dez.`;\n    const candles_on_now = await Tagger.getByTag('status_a'); // Select all burning candles \n    let message2 = `Agora tem ${candles_on_now.length}...`;\n    let chatData = {\n      speaker: null,\n      content: `<div style=\"position:relative; background: #ddd9d5;padding: 0.5rem; margin-left:-7px;margin-right:-7px;margin-bottom:-7px;margin-top:-27px\"><label class=\"titulo\" style=\"font-size:35px; color: #b02b2e;\">Velas</label><div style=\"position: absolute;top: 0;right: 0;width: 50px;height:50px;background: linear-gradient(45deg, #00000000 50%, #000000 50%);\"></div><br><label style=\"font-size: 15px\">${message1}</label><div style=\"margin-top:5px ;height: 5px;width: 100%;background: linear-gradient(20deg,  #000000 70%, #ddd9d500 70%);\"></div><p>${message2}</p></div>`};\n    ChatMessage.create(chatData, {});          \n  }\n}\n\n// FUNCTIONS\nasync function changeCandleStatusToOn(candleTag) {\n  let candle = await Tagger.getByTag(candleTag);  \n  \n  await Tagger.removeTags(candle[0], 'status_c');\n  await Tagger.removeTags(candle[0], 'status_a');\n  await Tagger.addTags(candle[0], 'status_a'); \n  \n  new Sequence()\n    .wait(1500)\n    .thenDo(async() => { \n      await candle[0].document.update({img: candleOn});\n    })  \n    .play()  \n}\n\nfunction getRandom(min, max) { // return between min and max\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}","folder":null,"sort":0,"permission":{"default":0,"VCcbc29NfY7OTjeI":3},"flags":{"core":{"sourceId":"Macro.PvJbhyyaQtNDLqYF"}}}
{"name":"Restaura Velas - Ten Candles","type":"script","author":"VCcbc29NfY7OTjeI","img":"icons/sundries/lights/torch-brown-lit.webp","scope":"global","command":"const candleOn = 'modules/md-random-stuff/stuff/tencandles/vela-1-acesa_VP8.webm';\nconst candleBlowingOut = 'modules/md-random-stuff/stuff/tencandles/vela-2-apagando_VP8.webm';\nconst candleOff = 'modules/md-random-stuff/stuff/tencandles/vela-3-apagada_VP8.png';\n\n/*\nicon: icons/sundries/lights/torch-brown-lit.webp\n*/\nconst version = 'v0.3';\n\nasync function restoreAllCandles() {\n  const candles = await Tagger.getByTag('candle');  \n  for (let candle of candles) {\n    await candle.document.update({img: candleOn});\n    await Tagger.removeTags(candle, 'status_c');\n    await Tagger.removeTags(candle, 'status_a');\n    await Tagger.addTags(candle, 'status_a');       \n  }\n}\n\nrestoreAllCandles();","folder":null,"sort":0,"permission":{"default":0,"VCcbc29NfY7OTjeI":3},"flags":{"core":{"sourceId":"Macro.Bjy2OhtVAN0ABk8W"}},"_id":"uaeSO6eR5kRUGjTX"}
{"_id":"zVrJxOr4RLYLhZcJ","name":"Executa Ciclo - Ten Candles","type":"script","author":"VCcbc29NfY7OTjeI","img":"icons/magic/time/clock-stopwatch-white-blue.webp","scope":"global","command":"// Press F5 to stop\nconst timeToTryToBlowOut = game.settings.get(\"md-random-stuff\", \"timetoblowcandle\"); // 10 secs\n\n/*\nicon: icons/magic/time/clock-stopwatch-white-blue.webp\n*/\nconst version = 'v0.1';\nsetInterval(() => game.macros.getName(\"Auto Danger - Ten Candles\").execute(), timeToTryToBlowOut);","folder":null,"sort":0,"permission":{"default":0,"VCcbc29NfY7OTjeI":3},"flags":{"core":{"sourceId":"Macro.BYFJV9RRmnEYWdrp"}}}
