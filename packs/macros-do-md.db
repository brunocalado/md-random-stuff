{"_id":"9A6qo693ftPViuSu","name":"Apaga Vela - Ten Candles","type":"script","author":"VCcbc29NfY7OTjeI","img":"icons/sundries/lights/candle-pillar-lit-yellow.webp","scope":"global","command":"const candleOn = 'modules/md-random-stuff/stuff/tencandles/vela-1-acesa_VP8.webm';\nconst candleBlowingOut = 'modules/md-random-stuff/stuff/tencandles/vela-2-apagando_VP8.webm';\nconst candleOff = 'modules/md-random-stuff/stuff/tencandles/vela-3-apagada_VP8.png';\nconst timeToBlowOut = 5000; // 5 secs - animation time - don't mess with it unless you know what you are doing.\nconst probability = game.settings.get(\"md-random-stuff\", \"chancetoblowcandle\");\n\n/*\nicon: icons/sundries/lights/candle-pillar-lit-yellow.webp\n\n//game.Gametime.doEvery({seconds:10}, \"TestMacro\"); // start to run\n//game.Gametime.flushQueue(); // stop to run\n\nconst currentSceneID = game.scenes.current.id;\ndangerZone.triggerZone('Vento', currentSceneID)\n*/\n\n/*\n== Important - Tags\nstatus_a = on\nstatus_b = Blowing Out\nstatus_c = off\n*/\n\nmain();\nconst version = 'v0.5';\n\nasync function main() {  \n  let candles = await Tagger.getByTag('status_a'); // Select all burning candles \n  let selectedCandle = candles[getRandom(0,candles.length-1)];\n  let candles_on = candles.length;\n  \n  if ( (candles.length>0) && shouldTheCandleDie(probability) ) { //avoid error    \n    changeCandleStatusToOff( Tagger.getTags(selectedCandle) ); // turn off the candle\n\n    let message1 = `Haviam dez.`;\n    let message2 = `Agora tem ${candles_on-1}...`;\n    let chatData = {\n      speaker: null,\n      content: `<div style=\"position:relative; background: #ddd9d5;padding: 0.5rem; margin-left:-7px;margin-right:-7px;margin-bottom:-7px;margin-top:-27px\"><label class=\"titulo\" style=\"font-size:35px; color: #b02b2e;\">Velas</label><div style=\"position: absolute;top: 0;right: 0;width: 50px;height:50px;background: linear-gradient(45deg, #00000000 50%, #000000 50%);\"></div><br><label style=\"font-size: 15px\">${message1}</label><div style=\"margin-top:5px ;height: 5px;width: 100%;background: linear-gradient(20deg,  #000000 70%, #ddd9d500 70%);\"></div><p>${message2}</p></div>`};\n    ChatMessage.create(chatData, {});          \n  }\n}\n\n// FUNCTIONS\nasync function changeCandleStatusToOff(candleTag) {\n  let candle = await Tagger.getByTag(candleTag);  \n\n  await Tagger.removeTags(candle[0], ['status_a', 'status_c'] );\n  await Tagger.addTags(candle[0], 'status_c'); \n  \n  new Sequence()\n    .wait(1500)\n    .thenDo(async() => { \n      await candle[0].update({img: candleBlowingOut});\n    })\n    .wait(timeToBlowOut)\n    .thenDo(async() => { \n      await candle[0].update({img: candleOff});\n    })      \n    .play()  \n}\n\nfunction getRandom(min, max) { // return between min and max\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\nfunction shouldTheCandleDie(probability) {  \n  if ( probability>=Math.random() ) {\n    return true;\n  } else {\n    return false;\n  }\n}","folder":null,"sort":0,"permission":{"default":0,"VCcbc29NfY7OTjeI":3},"flags":{"core":{"sourceId":"Macro.oWgyfTyH3LgIuXPU"}}}
{"_id":"EABQKBcY62LPptdo","name":"Apaga uma Vela - Ten Candles","type":"script","author":"VCcbc29NfY7OTjeI","img":"icons/sundries/lights/candle-unlit-red.webp","scope":"global","command":"const candleOn = 'modules/md-random-stuff/stuff/tencandles/vela-1-acesa_VP8.webm';\nconst candleBlowingOut = 'modules/md-random-stuff/stuff/tencandles/vela-2-apagando_VP8.webm';\nconst candleOff = 'modules/md-random-stuff/stuff/tencandles/vela-3-apagada_VP8.png';\nconst timeToBlowOut = 5000; // 5 secs - animation time - don't mess with it unless you know what you are doing.\n\n/* APAGA UMA VELA\nicon: icons/sundries/lights/candle-pillar-lit-yellow.webp\n\n*/\n\n/*\n== Important - Tags\nstatus_a = on\nstatus_b = Blowing Out\nstatus_c = off\n*/\n\nmain();\nconst version = 'v0.2';\n\nasync function main() {  \n  let candles = await Tagger.getByTag('status_a'); // Select all burning candles \n  let selectedCandle = candles[getRandom(0,candles.length-1)];\n  let candles_on = candles.length;\n  \n  if ( (candles.length>0) ) { //avoid error    \n    changeCandleStatusToOff( Tagger.getTags(selectedCandle) ); // turn off the candle\n\n    let message1 = `Haviam dez.`;\n    let message2 = `Agora tem ${candles_on-1}...`;\n    let chatData = {\n      speaker: null,\n      content: `<div style=\"position:relative; background: #ddd9d5;padding: 0.5rem; margin-left:-7px;margin-right:-7px;margin-bottom:-7px;margin-top:-27px\"><label class=\"titulo\" style=\"font-size:35px; color: #b02b2e;\">Velas</label><div style=\"position: absolute;top: 0;right: 0;width: 50px;height:50px;background: linear-gradient(45deg, #00000000 50%, #000000 50%);\"></div><br><label style=\"font-size: 15px\">${message1}</label><div style=\"margin-top:5px ;height: 5px;width: 100%;background: linear-gradient(20deg,  #000000 70%, #ddd9d500 70%);\"></div><p>${message2}</p></div>`};\n    ChatMessage.create(chatData, {});          \n  }\n}\n\n// FUNCTIONS\nasync function changeCandleStatusToOff(candleTag) {\n  let candle = await Tagger.getByTag(candleTag);  \n  \n  await Tagger.removeTags(candle[0], ['status_a', 'status_c']);\n  await Tagger.addTags(candle[0], 'status_c'); \n  \n  new Sequence()\n    .wait(1500)\n    .thenDo(async() => { \n      await candle[0].update({img: candleBlowingOut});\n    })\n    .wait(timeToBlowOut)\n    .thenDo(async() => { \n      await candle[0].update({img: candleOff});\n    })      \n    .play()  \n}\n\nfunction getRandom(min, max) { // return between min and max\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}","folder":null,"sort":0,"permission":{"default":0,"VCcbc29NfY7OTjeI":3},"flags":{"core":{"sourceId":"Macro.2fjSoTvhjSQOZ2GW"}}}
{"_id":"R0xdvRZywwPKLDVR","name":"Day Changer","type":"script","author":"5CTASB8SQvmVzaPs","img":"icons/magic/time/arrows-circling-green.webp","scope":"global","command":"// version 1.0\nconst sceneName = 'DA: River with Hut';\nconst day = 'modules/md-random-stuff/stuff/dungeon_alchemist/simple-river-hut-day.webp';\nconst dusk = 'modules/md-random-stuff/stuff/dungeon_alchemist/simple-river-hut-dusk.webp';\nconst night = 'modules/md-random-stuff/stuff/dungeon_alchemist/simple-river-hut-night.webp';\n\nif (canvas.scene.name===sceneName) {\n  main();\n}\n\nasync function main() {\n\n  if (canvas.scene.img===day) { // go to dusk \n    await canvas.scene.update({darkness: 0.35, globalLight: false, img: dusk});\n  } else if (canvas.scene.img===dusk) { // go to night \n    await canvas.scene.update({darkness: 0.8, globalLight: false, img: night});\n  } else if (canvas.scene.img===night) { // go to day \n    await canvas.scene.update({darkness: 0, globalLight: true, img: day});\n  }\n}","folder":null,"sort":0,"permission":{"default":0,"5CTASB8SQvmVzaPs":3},"flags":{"core":{"sourceId":"Macro.Xhz3Wk9hfWayp7OK"}}}
{"name":"Auto Danger - Ten Candles","type":"script","author":"VCcbc29NfY7OTjeI","img":"icons/weapons/thrown/bomb-fuse-red-black.webp","scope":"global","command":"const dangerZoneName = 'Vento'; // dangerzone danger\n\n/*\nicon: icons/weapons/thrown/bomb-fuse-red-black.webp\n*/\n\nconst currentSceneID = game.scenes.current.id;\ndangerZone.triggerZone(dangerZoneName, currentSceneID);","folder":null,"sort":0,"permission":{"default":0,"VCcbc29NfY7OTjeI":3},"flags":{"core":{"sourceId":"Macro.oddZGEi8Nr7cTmwD"}},"_id":"XZ0WQKjf5vOi67Zg"}
{"_id":"h9cKRYjZ5B8u9zp5","name":"Weapon Select","type":"script","author":"RD3haPluLGEe2l4e","img":"icons/commodities/tech/levers-colored.webp","scope":"global","command":"/*\n\nicon: icons/commodities/tech/levers-colored.webp\n*/\n\nconst version = 'v0.1';\n//const path = '3d/weapons/';\nconst path = 'modules/canvas3dcompendium/assets/weapons/';\n\nlet tokenD = canvas.scene.tokens.filter( e=> e.name==='Base Weapon' )[0];\n\n// id, name, path, scale, offsetY, rotateY, rotateZ\n// 0 |  1  |  2  |   3  |    4    |   5   |   6\nlet models = [\n    [0, 'Laser Gun 1', 'modules/md-random-stuff/stuff/arsenal/laser_gun.glb', '3', 100, 0, 0 ],\n    [1, 'Sniper Rifle 1', path + 'scifi/sci_fi_sniper_rifle.glb', '9', 0, 90, 0 ],\n    [2, 'Shotgun 1', path + 'modern/shotgun.glb', '8', 380, 0, 345 ],\n    [3, 'Sword Stun 1', path + 'scifi/scifi_stun_sword.glb', '10', 26, 0, 0 ],    \n    [4, 'Submachine Gun 1', path + 'scifi/sci-fi_submachine_gun.glb', '8', 180, 0, 0 ],        \n    [5, 'Quad Barrel shotgun', path + 'scifi/quad_barrel_shotgun.glb', '7', 200, 0, 0 ],\n    [6, 'Nemesis Sniper Rifle', path + 'scifi/nemesis_sniper_rifle/scene.gltf', '9', 90, 90, 0 ],            \n    [7, 'Cyborg Weapon', path + 'scifi/cyborg_weapon.glb', '7', 130, 90, 0 ],\n    [8, 'Planetside 2 Prototype', path + 'scifi/planetside_2_prototype_weapon.glb', '9', 0, 45, 0 ],\n    [9, 'ARX-160', path + 'modern/arx-160_weapon.glb', '6', 140, 0, 0 ],\n    [10, 'Pistol 1', path + 'scifi/scifi_pistol.glb', '5', 0, 0, 0 ],\n    [11, 'Submachine Gun 2', path + 'scifi/sci-fi_submachine_gun_2.glb', '7', 100, 0, 0 ],\n    [12, 'Sci Fi Weapon 1', path + 'scifi/sci-fi_gun.glb', '7', 56, 0, 350 ],\n    [13, 'Shotgun 2', path + 'modern/shotgun_2.glb', '7', 54, 90, 0 ]\n  ];\n\n/*\nicon: icons/commodities/tech/levers-colored.webp\n\n*/\n\nmain();\n\nfunction main() { \n  let counter = 0;\n  let modelsName = arrayColumn(models, 1); \n  let modelsNameList = ``;\n  modelsName.map((t) => {    \n    modelsNameList += `<option value=\"${counter}\">\"${t}\"</option>`;    \n    counter+=1;\n  });  \n  \n  let dialogue_content = `\n    <h2 style=\"text-align:center;\">Peace was never an option<h2>\n    <form>    \n      <div class=\"form-group\">      \n        <label for=\"aeType\">Weapon:</label>\n        <input list=\"aeTypes\" id=\"aeType\" name=\"aeType\">\n        <datalist id=\"aeTypes\">\n          ${modelsNameList}\n        </datalist>  \n      </div>\n    </form>\n`;\n\n  let applyChanges = false;\n  let dialogButtons = {\n    yes: {\n      icon: \"<i class='fas fa-check'></i>\",\n      label: `Change`,\n      callback: (html) => {\n        changeWeapon(html);\n      }\n    },\n    no: {\n      icon: \"<i class='fas fa-times'></i>\",\n      label: `Cancel`\n    }   \n  }\n\n  // Main Dialogue    \n  new Dialog({\n    title: `Weapon Select - ${version}`,\n    content: dialogue_content,\n    buttons: dialogButtons,\n    default: \"yes\",\n  }).render(true);\n}\n\nasync function changeWeapon(html) {\n  let weaponID = html.find(\"#aeType\")[0].value;\n  \n  let path = arrayColumn(models, 2)[weaponID]; \n  let scale = arrayColumn(models, 3)[weaponID]; \n  let offsetY = arrayColumn(models, 4)[weaponID]; \n  let rotationY = arrayColumn(models, 5)[weaponID]; \n  let rotationZ = arrayColumn(models, 6)[weaponID]; \n\n//  await tokenD.setFlag(\"levels-3d-preview\", \"model3d\", path); // path\n  await tokenD.update({\n    flags: {\"levels-3d-preview\": {\n      \"model3d\" : path,\n      \"scale\" : scale,\n      \"offsetY\": offsetY,\n      \"rotationY\": rotationY,\n      \"rotationZ\": rotationZ\n  }}})\n}\n\nfunction arrayColumn(twoDimensionalArray, column) {\n  const arrayColumn = (arr, n) => arr.map(x => x[n]);\n  return arrayColumn(twoDimensionalArray, column);\n}","folder":null,"sort":0,"permission":{"default":0,"RD3haPluLGEe2l4e":3},"flags":{"core":{"sourceId":"Macro.gQzcik98XcRPwoKU"}}}
{"_id":"pPu1N1Eawij6hORo","name":"Acende uma Vela - Ten Candles","type":"script","author":"VCcbc29NfY7OTjeI","img":"icons/sundries/lights/candle-lit-yellow.webp","scope":"global","command":"const candleOn = 'modules/md-random-stuff/stuff/tencandles/vela-1-acesa_VP8.webm';\nconst candleBlowingOut = 'modules/md-random-stuff/stuff/tencandles/vela-2-apagando_VP8.webm';\nconst candleOff = 'modules/md-random-stuff/stuff/tencandles/vela-3-apagada_VP8.png';\n\n/* ACENDE UMA VELA\nicon: icons/sundries/lights/candle-lit-yellow.webp\n\n*/\n\n/*\n== Important - Tags\nstatus_a = on\nstatus_b = Blowing Out\nstatus_c = off\n*/\n\nmain();\nconst version = 'v0.2';\n\nasync function main() {  \n  let candles = await Tagger.getByTag('status_c'); // Select all burning candles \n  let candlesLength = candles.length;\n  let selectedCandle;\n  \n  if ( candlesLength>0 && candlesLength<=10 ) { //avoid error    \n    selectedCandle = candles[getRandom(0,candles.length-1)];\n    changeCandleStatusToOn( Tagger.getTags(selectedCandle) ); // turn on the candle\n\n    let message1 = `Haviam dez.`;\n    const candles_on_now = await Tagger.getByTag('status_a'); // Select all burning candles \n    let message2 = `Agora tem ${candles_on_now.length}...`;\n    let chatData = {\n      speaker: null,\n      content: `<div style=\"position:relative; background: #ddd9d5;padding: 0.5rem; margin-left:-7px;margin-right:-7px;margin-bottom:-7px;margin-top:-27px\"><label class=\"titulo\" style=\"font-size:35px; color: #b02b2e;\">Velas</label><div style=\"position: absolute;top: 0;right: 0;width: 50px;height:50px;background: linear-gradient(45deg, #00000000 50%, #000000 50%);\"></div><br><label style=\"font-size: 15px\">${message1}</label><div style=\"margin-top:5px ;height: 5px;width: 100%;background: linear-gradient(20deg,  #000000 70%, #ddd9d500 70%);\"></div><p>${message2}</p></div>`};\n    ChatMessage.create(chatData, {});          \n  }\n}\n\n// FUNCTIONS\nasync function changeCandleStatusToOn(candleTag) {\n  let candle = await Tagger.getByTag(candleTag);  \n  \n  await Tagger.removeTags(candle[0], ['status_a', 'status_c'] );\n  await Tagger.addTags(candle[0], 'status_a'); \n  \n  new Sequence()\n    .wait(1500)\n    .thenDo(async() => { \n      await candle[0].update({img: candleOn});\n    })  \n    .play()  \n}\n\nfunction getRandom(min, max) { // return between min and max\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}","folder":null,"sort":0,"permission":{"default":0,"VCcbc29NfY7OTjeI":3},"flags":{"core":{"sourceId":"Macro.PvJbhyyaQtNDLqYF"}}}
{"_id":"uaeSO6eR5kRUGjTX","name":"Restaura Velas - Ten Candles","type":"script","author":"VCcbc29NfY7OTjeI","img":"icons/sundries/lights/torch-brown-lit.webp","scope":"global","command":"const candleOn = 'modules/md-random-stuff/stuff/tencandles/vela-1-acesa_VP8.webm';\nconst candleBlowingOut = 'modules/md-random-stuff/stuff/tencandles/vela-2-apagando_VP8.webm';\nconst candleOff = 'modules/md-random-stuff/stuff/tencandles/vela-3-apagada_VP8.png';\n\n/*\nicon: icons/sundries/lights/torch-brown-lit.webp\n*/\nconst version = 'v0.4';\nawait restoreAllCandles();\n\nasync function restoreAllCandles() {\n  let candles = await Tagger.getByTag('candle');  \n  for (let candle of candles) {\n    console.log(candle)\n    await candle.update({img: candleOn});\n    await Tagger.removeTags( candle, ['status_c', 'status_a'] );\n    await Tagger.addTags(candle, 'status_a');       \n  }\n}","folder":null,"sort":0,"permission":{"default":0,"VCcbc29NfY7OTjeI":3},"flags":{"core":{"sourceId":"Macro.Bjy2OhtVAN0ABk8W"}}}
{"_id":"zVrJxOr4RLYLhZcJ","name":"Executa Ciclo - Ten Candles","type":"script","author":"VCcbc29NfY7OTjeI","img":"icons/magic/time/clock-stopwatch-white-blue.webp","scope":"global","command":"// Press F5 to stop\nconst timeToTryToBlowOut = game.settings.get(\"md-random-stuff\", \"timetoblowcandle\"); // 10 secs\n\n/*\nicon: icons/magic/time/clock-stopwatch-white-blue.webp\n*/\nconst version = 'v0.1';\nsetInterval(() => game.macros.getName(\"Auto Danger - Ten Candles\").execute(), timeToTryToBlowOut);","folder":null,"sort":0,"permission":{"default":0,"VCcbc29NfY7OTjeI":3},"flags":{"core":{"sourceId":"Macro.BYFJV9RRmnEYWdrp"}}}
